# How to Use `app.py` — CLI Color Prediction Guide

**Author:** Ali Pilehvar Meibody

A command-line tool that uses trained SVR (Support Vector Regression) models to predict ceramic glaze colors in the CIE L\*a\*b\* color space.

---

## Prerequisites

### 1. Python Dependencies

Make sure you have the following packages installed:

```bash
pip install numpy pandas scikit-learn joblib
```

### 2. Required Files

Before running `app.py`, the following files **must** exist in the same directory:

| File | Purpose |
|------|---------|
| `svr_L_star.joblib` | Trained SVR model for L\* prediction |
| `svr_a_star.joblib` | Trained SVR model for a\* prediction |
| `svr_b_star.joblib` | Trained SVR model for b\* prediction |
| `full_input_space_predictions.csv` | Pre-computed prediction table for inverse lookup |

> If these files are missing, run `prepared_pre_trainedmodel.py` first to generate them.

---

## Running the App

```bash
python app.py
```

On launch the program loads the three SVR models and the prediction CSV, then presents an interactive menu.

---

## Modes

### Mode 1 — Forward Prediction

**Purpose:** Given process parameters, predict the resulting CIE L\*a\*b\* color values.

**Inputs:**

| Parameter | Type | Accepted Values |
|-----------|------|-----------------|
| Redox Agent | Integer | `0` (No Redox), `1` (1x Redox), `2` (2x Redox) |
| Temperature | Float | Temperature in °C |
| Time | Float | Duration in minutes |

**How it works:**

1. Select **`1`** from the main menu.
2. Enter the three process parameters when prompted.
3. The predicted L\*, a\*, b\* values are displayed.
4. Choose whether to predict another set or return to the menu.

**Example session:**

```
  Redox Agent  (0 / 1 / 2)  : 1
  Temperature  (°C)         : 1050
  Time         (min)        : 60

  +-------------------------------+
  |    Predicted Color Values      |
  +-------------------------------+
  |  L*  =  55.1234              |
  |  a*  =  12.5678              |
  |  b*  =  -3.9012              |
  +-------------------------------+
```

**Output:** Results are saved to `forward_results.csv` when you finish.

---

### Mode 2 — Inverse Lookup

**Purpose:** Given desired L\*a\*b\* color values, find the closest matching process parameters from the pre-computed prediction table.

**Inputs:**

| Parameter | Type | Description |
|-----------|------|-------------|
| Desired L\* | Float | Target lightness |
| Desired a\* | Float | Target red-green axis |
| Desired b\* | Float | Target yellow-blue axis |
| Number of matches | Integer | How many top results to return (default: 5) |

**How it works:**

1. Select **`2`** from the main menu.
2. Enter the desired L\*, a\*, b\* values.
3. Specify how many closest matches you want (or press Enter for 5).
4. The tool computes the Euclidean distance (ΔE) between your target and every row in the prediction table, then displays the top matches ranked by smallest ΔE.
5. Choose whether to search for another color or return to the menu.

**Example session:**

```
  Desired L*  : 55.0
  Desired a*  : 12.0
  Desired b*  : -4.0
  How many best matches? (default 5): 3

  Top 3 closest matches for L*=55.0, a*=12.0, b*=-4.0

  Rank   Redox  Temp(°C)  Time(min)   L*_pred  a*_pred  b*_pred       ΔE
  ----------------------------------------------------------------------
  1          1      1050        60    55.123   12.568   -3.901    0.732
  2          1      1060        55    54.890   11.845   -4.120    0.845
  3          2      1040        65    55.450   12.300   -3.650    1.023
  ----------------------------------------------------------------------
```

**Output:** Results are saved to `inverse_results.csv` when you finish.

---

## Output Files

| File | Generated By | Contents |
|------|--------------|----------|
| `forward_results.csv` | Mode 1 | Columns: Redox Agent, Temperature, Time, L\*\_pred, a\*\_pred, b\*\_pred |
| `inverse_results.csv` | Mode 2 | Columns: Desired\_L\*, Desired\_a\*, Desired\_b\*, Rank, Redox Agent, Temperature, Time, Pred\_L\*, Pred\_a\*, Pred\_b\*, DeltaE |

---

## Quitting

Press **`q`**, `quit`, or `exit` at the main menu to close the application.
